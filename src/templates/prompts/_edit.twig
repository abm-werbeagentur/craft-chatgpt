{% extends '_layouts/cp' %}
{% import '_includes/forms' as forms %}

{% set isNewPrompt = true %}
{% if prompt.id %}
	{% set isNewPrompt = false %}
{% endif %}

{% if isNewPrompt %}
	{% set title = 'New Prompt' %}
{% else %}
	{% set title = 'Edit Prompt' %}
{% endif %}

{% set selectedSubnavItem = 'prompts' %}

{% set crumbs = [
    { label: 'Chat GPT'|t('abm-chatgpt'), url: url('abm-chatgpt') },
    { label: 'Prompts'|t('abm-chatgpt'), url: url('abm-chatgpt/prompts') }
] %}

{% set fullPageForm = true %}

{% block content %}
    {{ forms.hidden({
        name: 'action',
        value: 'abm-chatgpt/prompts/save'
    }) }}

	{% if not isNewPrompt %}
		{{ forms.hidden({
			name: 'id',
			value: prompt.id
		}) }}
	{% endif %}

    {{ forms.textField({
        label: 'Label'|t('app'),
        name: 'label',
        errors: prompt.getErrors('label'),
        required: true,
        first: true,
        value: prompt.label,
        autofocus: true,
    }) }}

    <div class="abm-slider field">
        <div class="heading">
            <label>{{ 'Temperature'|t('abm-chatgpt') }}</label>
		</div>
		<div class="instructions">
            <p>{{ 'temperatureDescription'|t('abm-chatgpt')}}</p>
        </div>
        <div class="flex">
            <input
                    type="range"
                    step="0.1"
                    min="0"
                    max="2"
                    class="slider"
                    id="temperature"
                    value="{{ prompt.temperature }}"
                    name="temperature"
                    data-gtm-form-interact-field-id="0"
            >
            <span>{{ prompt.temperature }}</span>
        </div>
    </div>

	{{ forms.lightswitchField({
        label: 'Replace the text'|t('abm-chatgpt'),
        instructions: 'promptReplaceText'|t('abm-chatgpt'),
        name: 'replaceText',
        on: (prompt) ? prompt.replaceText : true
    }) }}

    {{ forms.textAreaField({
        label: 'Prompt Template'|t('abm-chatgpt'),
        name: 'template',
        errors: prompt.getErrors('template'),
        required: true,
        rows: 6,
        value: prompt.template,
    }) }}

{% endblock %}

{% block details %}
    <div id="settings" class="meta">
        {% include 'abm-chatgpt/_components/_promptSidebar' with {'element': prompt} %}
    </div>
{% endblock %}